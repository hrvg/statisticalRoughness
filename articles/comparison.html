<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Comparison with a previous approach • statisticalRoughness</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Comparison with a previous approach">
<meta property="og:description" content="statisticalRoughness">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">statisticalRoughness</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.0.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Computing Hurst exponents</a>
      <ul class="dropdown-menu" role="menu">
<li>
          <a href="../articles/getting-started.html">Getting started</a>
        </li>
        <li>
          <a href="../articles/factoring.html">Factoring</a>
        </li>
        <li>
          <a href="../articles/tiling.html">Tiling rasters</a>
        </li>
        <li>
          <a href="../articles/computing%20.html">Computing</a>
        </li>
        <li>
          <a href="../articles/comparison%20.html">Comparison with a previous approach</a>
        </li>
      </ul>
</li>
    <li class="divider">
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">2D Fourier analyis of topography</a>
      <ul class="dropdown-menu" role="menu">
<li>
          <a href="../articles/basic_2dft.html">A basic 2D Fourier analysis of topography</a>
        </li>
        <li>
          <a href="../articles/rotating_rasters.html">Rotating rasters along 2DFT main components</a>
        </li>
      </ul>
</li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><link href="comparison_files/anchor-sections-1.0/anchor-sections.css" rel="stylesheet">
<script src="comparison_files/anchor-sections-1.0/anchor-sections.js"></script><script src="comparison_files/kePrint-0.0.1/kePrint.js"></script><link href="comparison_files/lightable-0.0.1/lightable.css" rel="stylesheet">
<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Comparison with a previous approach</h1>
                        <h4 class="author">Hervé Guillon</h4>
                        
            <h4 class="date">08 December 2020</h4>
      
      
      <div class="hidden name"><code>comparison.Rmd</code></div>

    </div>

    
    
<div id="self-affine-scaling-of-surfaces" class="section level1">
<h1 class="hasAnchor">
<a href="#self-affine-scaling-of-surfaces" class="anchor"></a>Self-Affine Scaling of Surfaces</h1>
<p>The width of a surface <span class="math inline">\(S\)</span> of vertical dimension <span class="math inline">\(z\)</span> and lateral dimension <span class="math inline">\((x,y)\)</span> is defined as:</p>
<p><span class="math display">\[\left\langle w \right\rangle_R = \sqrt{\left\langle  \left\langle u^2(x,y) \right\rangle_R \right\rangle_s} \]</span> with <span class="math inline">\(u_R\)</span> the deviation function: <span class="math display">\[u_R(x,y) = z(x,y) - \left\langle z(x,y) \right\rangle_R \]</span></p>
<p>Notice that <span class="math inline">\(\left\langle w \right\rangle_R\)</span> is an average over all regions the surface <span class="math inline">\(S\)</span> with lateral dimensions <span class="math inline">\(R\)</span> and corresponds to the average over <span class="math inline">\(S\)</span> of the standard deviations over <span class="math inline">\(R\)</span>.</p>
<p><span class="math display">\[\left\langle w \right\rangle_R \sim R^H\]</span></p>
<p><span class="math inline">\(H\)</span> depends on the size <span class="math inline">\(L_S\)</span> of the surface <span class="math inline">\(S\)</span> and the lateral dimensions <span class="math inline">\(R\)</span>. In the following, I drop the subscript and equate <span class="math inline">\(L_s\)</span> with <span class="math inline">\(L\)</span>.</p>
<p>When dealing with data on a grid, it is obviously convenient if the lateral dimensions <span class="math inline">\(R\)</span> corresponds to factors of <span class="math inline">\(L\)</span>. A factor <span class="math inline">\(b\in\mathbb{N}\)</span> of <span class="math inline">\(a\in\mathbb{N}\)</span> is such that the remainder of <span class="math inline">\(a/b\)</span> is zero and <span class="math inline">\(b \notin \left\{1;a\right\}\)</span>.</p>
</div>
<div id="guillon2020s-approach" class="section level1">
<h1 class="hasAnchor">
<a href="#guillon2020s-approach" class="anchor"></a><span class="citation">Guillon et al. (2020)</span>’s approach</h1>
<p>The original set of scales was defined from 5 seeds <span class="math inline">\(s = \left\{ 2;3;5;7;9 \right\}\)</span> (the prime numbers between 2 and 10) and used as multiplier for the power of 2 from 0 to 13:</p>
<p><span class="math display">\[ \left\{R_i\right\} = \left\{s_i \cdot 2^{k}\right\}_{i = 1, k = 0}^{i = 5, k = 13}\]</span></p>
<pre class="warning"><code>colnames(.Rs) &lt;- seeds
rownames(.Rs) &lt;- 2**(0:13)
.Rs %&gt;% 
kable("html") %&gt;% 
add_header_above(header = c("power of two" = 1, "seed" = 5))  %&gt;%
kable_styling(bootstrap_options = c("striped", "hover"),
    position = "center",
    full_width = FALSE)</code></pre>
<p>As some of the scale failed to compute, they were filtered to be lower than <span class="math inline">\(10^4\)</span> (or <span class="math inline">\(10^5\)</span> m in map units):</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">seeds</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">5</span>,<span class="fl">7</span>,<span class="fl">9</span><span class="op">)</span>
<span class="va">Rs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">seeds</span>, <span class="kw">function</span><span class="op">(</span><span class="va">seed</span><span class="op">)</span> <span class="fl">2</span><span class="op">**</span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">13</span><span class="op">)</span> <span class="op">*</span> <span class="va">seed</span><span class="op">)</span>
<span class="va">.Rs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span><span class="op">(</span><span class="va">cbind</span>, <span class="va">Rs</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">Lmax</span> <span class="op">&lt;-</span> <span class="fl">8192</span>
<span class="va">.Rs</span> <span class="op">&lt;-</span> <span class="va">.Rs</span> <span class="op">%&gt;%</span>
<span class="fu">mutate_all</span><span class="op">(</span><span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">.</span> <span class="op">&gt;</span> <span class="va">Lmax</span>, <span class="cn">NA</span>, <span class="va">.</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">.Rs</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">seeds</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">.Rs</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fl">2</span><span class="op">**</span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">13</span><span class="op">)</span>
<span class="va">.Rs</span> <span class="op">%&gt;%</span>
<span class="fu">kable</span><span class="op">(</span><span class="st">"html"</span><span class="op">)</span> <span class="op">%&gt;%</span> 
<span class="fu">add_header_above</span><span class="op">(</span>header <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"power of two"</span> <span class="op">=</span> <span class="fl">1</span>, <span class="st">"seed"</span> <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span>  <span class="op">%&gt;%</span>
<span class="fu">kable_styling</span><span class="op">(</span>bootstrap_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"striped"</span>, <span class="st">"hover"</span><span class="op">)</span>,
    position <span class="op">=</span> <span class="st">"center"</span>,
    full_width <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">%&gt;%</span>
<span class="fu">row_spec</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, color <span class="op">=</span> <span class="st">"white"</span>, background <span class="op">=</span> <span class="st">"steelblue"</span><span class="op">)</span></code></pre></div>
<table class="table table table-striped table-hover">
<thead>
<tr>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="1">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
power of two
</div>
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="5">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
seed
</div>
</th>
</tr>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
2
</th>
<th style="text-align:right;">
3
</th>
<th style="text-align:right;">
5
</th>
<th style="text-align:right;">
7
</th>
<th style="text-align:right;">
9
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;color: white !important;background-color: steelblue !important;">
1
</td>
<td style="text-align:right;color: white !important;background-color: steelblue !important;">
2
</td>
<td style="text-align:right;color: white !important;background-color: steelblue !important;">
3
</td>
<td style="text-align:right;color: white !important;background-color: steelblue !important;">
5
</td>
<td style="text-align:right;color: white !important;background-color: steelblue !important;">
7
</td>
<td style="text-align:right;color: white !important;background-color: steelblue !important;">
9
</td>
</tr>
<tr>
<td style="text-align:left;color: white !important;background-color: steelblue !important;">
2
</td>
<td style="text-align:right;color: white !important;background-color: steelblue !important;">
4
</td>
<td style="text-align:right;color: white !important;background-color: steelblue !important;">
6
</td>
<td style="text-align:right;color: white !important;background-color: steelblue !important;">
10
</td>
<td style="text-align:right;color: white !important;background-color: steelblue !important;">
14
</td>
<td style="text-align:right;color: white !important;background-color: steelblue !important;">
18
</td>
</tr>
<tr>
<td style="text-align:left;color: white !important;background-color: steelblue !important;">
4
</td>
<td style="text-align:right;color: white !important;background-color: steelblue !important;">
8
</td>
<td style="text-align:right;color: white !important;background-color: steelblue !important;">
12
</td>
<td style="text-align:right;color: white !important;background-color: steelblue !important;">
20
</td>
<td style="text-align:right;color: white !important;background-color: steelblue !important;">
28
</td>
<td style="text-align:right;color: white !important;background-color: steelblue !important;">
36
</td>
</tr>
<tr>
<td style="text-align:left;color: white !important;background-color: steelblue !important;">
8
</td>
<td style="text-align:right;color: white !important;background-color: steelblue !important;">
16
</td>
<td style="text-align:right;color: white !important;background-color: steelblue !important;">
24
</td>
<td style="text-align:right;color: white !important;background-color: steelblue !important;">
40
</td>
<td style="text-align:right;color: white !important;background-color: steelblue !important;">
56
</td>
<td style="text-align:right;color: white !important;background-color: steelblue !important;">
72
</td>
</tr>
<tr>
<td style="text-align:left;color: white !important;background-color: steelblue !important;">
16
</td>
<td style="text-align:right;color: white !important;background-color: steelblue !important;">
32
</td>
<td style="text-align:right;color: white !important;background-color: steelblue !important;">
48
</td>
<td style="text-align:right;color: white !important;background-color: steelblue !important;">
80
</td>
<td style="text-align:right;color: white !important;background-color: steelblue !important;">
112
</td>
<td style="text-align:right;color: white !important;background-color: steelblue !important;">
144
</td>
</tr>
<tr>
<td style="text-align:left;">
32
</td>
<td style="text-align:right;">
64
</td>
<td style="text-align:right;">
96
</td>
<td style="text-align:right;">
160
</td>
<td style="text-align:right;">
224
</td>
<td style="text-align:right;">
288
</td>
</tr>
<tr>
<td style="text-align:left;">
64
</td>
<td style="text-align:right;">
128
</td>
<td style="text-align:right;">
192
</td>
<td style="text-align:right;">
320
</td>
<td style="text-align:right;">
448
</td>
<td style="text-align:right;">
576
</td>
</tr>
<tr>
<td style="text-align:left;">
128
</td>
<td style="text-align:right;">
256
</td>
<td style="text-align:right;">
384
</td>
<td style="text-align:right;">
640
</td>
<td style="text-align:right;">
896
</td>
<td style="text-align:right;">
1152
</td>
</tr>
<tr>
<td style="text-align:left;">
256
</td>
<td style="text-align:right;">
512
</td>
<td style="text-align:right;">
768
</td>
<td style="text-align:right;">
1280
</td>
<td style="text-align:right;">
1792
</td>
<td style="text-align:right;">
2304
</td>
</tr>
<tr>
<td style="text-align:left;">
512
</td>
<td style="text-align:right;">
1024
</td>
<td style="text-align:right;">
1536
</td>
<td style="text-align:right;">
2560
</td>
<td style="text-align:right;">
3584
</td>
<td style="text-align:right;">
4608
</td>
</tr>
<tr>
<td style="text-align:left;">
1024
</td>
<td style="text-align:right;">
2048
</td>
<td style="text-align:right;">
3072
</td>
<td style="text-align:right;">
5120
</td>
<td style="text-align:right;">
7168
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
2048
</td>
<td style="text-align:right;">
4096
</td>
<td style="text-align:right;">
6144
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
4096
</td>
<td style="text-align:right;">
8192
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
8192
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Rs &lt;- lapply(Rs, function(R) R[R &lt; Lmax])</span>
<span class="co"># print(Rs)</span></code></pre></div>
<p>The size of the surfaces <span class="math inline">\(L\)</span> over which the scaling is computed were defined as having at least 5 factors:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Ls</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">Rs</span>, <span class="kw">function</span><span class="op">(</span><span class="va">R</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/headtail.html">tail</a></span><span class="op">(</span><span class="va">R</span>, <span class="op">-</span><span class="fl">5</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">Ls</span><span class="op">)</span>
<span class="co">#&gt; [[1]]</span>
<span class="co">#&gt; [1]    64   128   256   512  1024  2048  4096  8192 16384</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[2]]</span>
<span class="co">#&gt; [1]    96   192   384   768  1536  3072  6144 12288 24576</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[3]]</span>
<span class="co">#&gt; [1]   160   320   640  1280  2560  5120 10240 20480 40960</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[4]]</span>
<span class="co">#&gt; [1]   224   448   896  1792  3584  7168 14336 28672 57344</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[5]]</span>
<span class="co">#&gt; [1]   288   576  1152  2304  4608  9216 18432 36864 73728</span></code></pre></div>
<p>The run with the largest scale (<span class="math inline">\(L = 9216\)</span>) failed such that the final set of surface sizes <span class="math inline">\(L\)</span> is:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Ls</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/headtail.html">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="va">Ls</span><span class="op">)</span><span class="op">)</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">Ls</span><span class="op">)</span>
<span class="co">#&gt;  [1]    64    96   128   160   192   224   256   288   320   384   448   512</span>
<span class="co">#&gt; [13]   576   640   768   896  1024  1152  1280  1536  1792  2048  2304  2560</span>
<span class="co">#&gt; [25]  3072  3584  4096  4608  5120  6144  7168  8192  9216 10240 12288 14336</span>
<span class="co">#&gt; [37] 16384 18432 20480 24576 28672 36864 40960 57344</span></code></pre></div>
<p>The following table displays the set of 32 surface size <span class="math inline">\(\left\{L_i\right\}_{i = 1}^{n_S}\)</span> and the associated set of lateral dimensions <span class="math inline">\(\left\{R_i\right\}_{i = 1}^{n_R}\)</span> with <span class="math inline">\(n_L = 32\)</span> and <span class="math inline">\(n_R = 5\)</span> and where <span class="math inline">\(R_i\)</span> are the largest <span class="math inline">\(n_R\)</span> factors for a given <span class="math inline">\(S\)</span>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Ls_factors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/transpose.html">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">Ls</span>, <span class="kw">function</span><span class="op">(</span><span class="va">L</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/headtail.html">tail</a></span><span class="op">(</span><span class="fu"><a href="../reference/get_factors.html">get_factors</a></span><span class="op">(</span><span class="va">L</span><span class="op">)</span>, <span class="fl">6</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">df2017</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">Ls_factors</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">df2017</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"R."</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span>, <span class="st">"L"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">df2017</span><span class="op">)</span>
<span class="co">#&gt;     R.1  R.2  R.3   R.4   R.5     L</span>
<span class="co">#&gt; 1     2    4    8    16    32    64</span>
<span class="co">#&gt; 2    12   16   24    32    48    96</span>
<span class="co">#&gt; 3     4    8   16    32    64   128</span>
<span class="co">#&gt; 4    16   20   32    40    80   160</span>
<span class="co">#&gt; 5    24   32   48    64    96   192</span>
<span class="co">#&gt; 6    16   28   32    56   112   224</span>
<span class="co">#&gt; 7     8   16   32    64   128   256</span>
<span class="co">#&gt; 8    36   48   72    96   144   288</span>
<span class="co">#&gt; 9    32   40   64    80   160   320</span>
<span class="co">#&gt; 10   48   64   96   128   192   384</span>
<span class="co">#&gt; 11   32   56   64   112   224   448</span>
<span class="co">#&gt; 12   16   32   64   128   256   512</span>
<span class="co">#&gt; 13   72   96  144   192   288   576</span>
<span class="co">#&gt; 14   64   80  128   160   320   640</span>
<span class="co">#&gt; 15   96  128  192   256   384   768</span>
<span class="co">#&gt; 16   64  112  128   224   448   896</span>
<span class="co">#&gt; 17   32   64  128   256   512  1024</span>
<span class="co">#&gt; 18  144  192  288   384   576  1152</span>
<span class="co">#&gt; 19  128  160  256   320   640  1280</span>
<span class="co">#&gt; 20  192  256  384   512   768  1536</span>
<span class="co">#&gt; 21  128  224  256   448   896  1792</span>
<span class="co">#&gt; 22   64  128  256   512  1024  2048</span>
<span class="co">#&gt; 23  288  384  576   768  1152  2304</span>
<span class="co">#&gt; 24  256  320  512   640  1280  2560</span>
<span class="co">#&gt; 25  384  512  768  1024  1536  3072</span>
<span class="co">#&gt; 26  256  448  512   896  1792  3584</span>
<span class="co">#&gt; 27  128  256  512  1024  2048  4096</span>
<span class="co">#&gt; 28  576  768 1152  1536  2304  4608</span>
<span class="co">#&gt; 29  512  640 1024  1280  2560  5120</span>
<span class="co">#&gt; 30  768 1024 1536  2048  3072  6144</span>
<span class="co">#&gt; 31  512  896 1024  1792  3584  7168</span>
<span class="co">#&gt; 32  256  512 1024  2048  4096  8192</span>
<span class="co">#&gt; 33 1152 1536 2304  3072  4608  9216</span>
<span class="co">#&gt; 34 1024 1280 2048  2560  5120 10240</span>
<span class="co">#&gt; 35 1536 2048 3072  4096  6144 12288</span>
<span class="co">#&gt; 36 1024 1792 2048  3584  7168 14336</span>
<span class="co">#&gt; 37  512 1024 2048  4096  8192 16384</span>
<span class="co">#&gt; 38 2304 3072 4608  6144  9216 18432</span>
<span class="co">#&gt; 39 2048 2560 4096  5120 10240 20480</span>
<span class="co">#&gt; 40 3072 4096 6144  8192 12288 24576</span>
<span class="co">#&gt; 41 2048 3584 4096  7168 14336 28672</span>
<span class="co">#&gt; 42 4608 6144 9216 12288 18432 36864</span>
<span class="co">#&gt; 43 4096 5120 8192 10240 20480 40960</span>
<span class="co">#&gt; 44 4096 7168 8192 14336 28672 57344</span></code></pre></div>
</div>
<div id="statisticalroughnesss-approach" class="section level1">
<h1 class="hasAnchor">
<a href="#statisticalroughnesss-approach" class="anchor"></a><code>statisticalRoughness</code>’s approach</h1>
<p>However, there are <span class="math inline">\(5369\)</span> numbers that satisfy the conditions <span class="citation">Guillon et al. (2020)</span> used to select <span class="math inline">\(\left\{L_i\right\}_{i = 1}^{n_S}\)</span> and <span class="math inline">\(\left\{R_i\right\}_{i = 1}^{n_R}\)</span> with <span class="math inline">\(n_R = 5\)</span> and 6 of them are smaller than the minimum surface size. This is important as it potentially leverages information at a finer spatial scale.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">nR</span> <span class="op">&lt;-</span> <span class="fl">5</span>
<span class="va">RL</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_all_R_L.html">get_all_R_L</a></span><span class="op">(</span><span class="va">Lmax</span>, <span class="va">nR</span>, logfilter <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">RL</span><span class="op">$</span><span class="va">allL</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1] 4324</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/headtail.html">head</a></span><span class="op">(</span><span class="va">RL</span><span class="op">$</span><span class="va">allL</span><span class="op">[</span><span class="va">RL</span><span class="op">$</span><span class="va">allL</span> <span class="op">&lt;</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">Ls</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1] 24 30 36 40 42 48</span></code></pre></div>
</div>
<div id="comparison-of-factor-distributions" class="section level1">
<h1 class="hasAnchor">
<a href="#comparison-of-factor-distributions" class="anchor"></a>Comparison of Factor Distributions</h1>
<p>So why use the 32 surface sizes defined in <span class="citation">Guillon et al. (2020)</span>? What is so peculiar about them?</p>
<p>They have been initially defined as: <span class="math display">\[ \left\{R_i\right\} = \left\{s_i \cdot 2^{k}\right\}_{i = 1, k = 0}^{i = 5, k = 13}\]</span></p>
<p>Because of the <span class="math inline">\(2^{k}\)</span> part of this definition, the factors <span class="math inline">\(R\)</span> are perfectly logarithmically distributed on the number line for <span class="math inline">\(s = 2\)</span> and well-behaved for the other seeds. Is this true for the approach implemented in <code>statisticalRoughness</code>?</p>
<div id="factor-distribution-from-guillon2020" class="section level2">
<h2 class="hasAnchor">
<a href="#factor-distribution-from-guillon2020" class="anchor"></a>Factor Distribution from <span class="citation">Guillon et al. (2020)</span>
</h2>
<p>The following plots identify the number <span class="math inline">\(L\)</span> and its 5 largest factors on the number line.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">numberline</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="va">Lmax</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span>
<span class="kw">for</span> <span class="op">(</span><span class="va">k</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_along</a></span><span class="op">(</span><span class="va">Ls</span><span class="op">)</span><span class="op">)</span><span class="op">{</span>
    <span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>pty <span class="op">=</span> <span class="st">"s"</span><span class="op">)</span>
    <span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html">plot</a></span><span class="op">(</span><span class="va">numberline</span>, log <span class="op">=</span> <span class="st">"xy"</span>, lty <span class="op">=</span> <span class="fl">1</span>, ylab <span class="op">=</span> <span class="st">"Numbers"</span>, type <span class="op">=</span> <span class="st">"l"</span>, main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">nR</span>, <span class="st">"largest Factors for"</span>, <span class="va">Ls</span><span class="op">[</span><span class="va">k</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>
    <span class="fu"><a href="https://rdrr.io/r/graphics/grid.html">grid</a></span><span class="op">(</span><span class="op">)</span>
    <span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">numberline</span><span class="op">[</span><span class="va">numberline</span> <span class="op">%in%</span> <span class="va">df2017</span><span class="op">[</span><span class="va">k</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span><span class="op">]</span>, <span class="va">numberline</span><span class="op">[</span><span class="va">numberline</span> <span class="op">%in%</span> <span class="va">df2017</span><span class="op">[</span><span class="va">k</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span><span class="op">]</span>, col <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span>
    <span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">numberline</span><span class="op">[</span><span class="va">numberline</span> <span class="op">%in%</span> <span class="va">df2017</span><span class="op">[</span><span class="va">k</span>, <span class="fl">6</span><span class="op">]</span><span class="op">]</span>, <span class="va">numberline</span><span class="op">[</span><span class="va">numberline</span> <span class="op">%in%</span> <span class="va">df2017</span><span class="op">[</span><span class="va">k</span>, <span class="fl">6</span><span class="op">]</span><span class="op">]</span>, col <span class="op">=</span> <span class="st">"blue"</span>, pch<span class="op">=</span><span class="fl">19</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p><img src="comparison_files/figure-html/unnamed-chunk-8-1.png" width="672"><img src="comparison_files/figure-html/unnamed-chunk-8-2.png" width="672"><img src="comparison_files/figure-html/unnamed-chunk-8-3.png" width="672"><img src="comparison_files/figure-html/unnamed-chunk-8-4.png" width="672"><img src="comparison_files/figure-html/unnamed-chunk-8-5.png" width="672"><img src="comparison_files/figure-html/unnamed-chunk-8-6.png" width="672"><img src="comparison_files/figure-html/unnamed-chunk-8-7.png" width="672"><img src="comparison_files/figure-html/unnamed-chunk-8-8.png" width="672"><img src="comparison_files/figure-html/unnamed-chunk-8-9.png" width="672"><img src="comparison_files/figure-html/unnamed-chunk-8-10.png" width="672"><img src="comparison_files/figure-html/unnamed-chunk-8-11.png" width="672"><img src="comparison_files/figure-html/unnamed-chunk-8-12.png" width="672"><img src="comparison_files/figure-html/unnamed-chunk-8-13.png" width="672"><img src="comparison_files/figure-html/unnamed-chunk-8-14.png" width="672"><img src="comparison_files/figure-html/unnamed-chunk-8-15.png" width="672"><img src="comparison_files/figure-html/unnamed-chunk-8-16.png" width="672"><img src="comparison_files/figure-html/unnamed-chunk-8-17.png" width="672"><img src="comparison_files/figure-html/unnamed-chunk-8-18.png" width="672"><img src="comparison_files/figure-html/unnamed-chunk-8-19.png" width="672"><img src="comparison_files/figure-html/unnamed-chunk-8-20.png" width="672"><img src="comparison_files/figure-html/unnamed-chunk-8-21.png" width="672"><img src="comparison_files/figure-html/unnamed-chunk-8-22.png" width="672"><img src="comparison_files/figure-html/unnamed-chunk-8-23.png" width="672"><img src="comparison_files/figure-html/unnamed-chunk-8-24.png" width="672"><img src="comparison_files/figure-html/unnamed-chunk-8-25.png" width="672"><img src="comparison_files/figure-html/unnamed-chunk-8-26.png" width="672"><img src="comparison_files/figure-html/unnamed-chunk-8-27.png" width="672"><img src="comparison_files/figure-html/unnamed-chunk-8-28.png" width="672"><img src="comparison_files/figure-html/unnamed-chunk-8-29.png" width="672"><img src="comparison_files/figure-html/unnamed-chunk-8-30.png" width="672"><img src="comparison_files/figure-html/unnamed-chunk-8-31.png" width="672"><img src="comparison_files/figure-html/unnamed-chunk-8-32.png" width="672"><img src="comparison_files/figure-html/unnamed-chunk-8-33.png" width="672"><img src="comparison_files/figure-html/unnamed-chunk-8-34.png" width="672"><img src="comparison_files/figure-html/unnamed-chunk-8-35.png" width="672"><img src="comparison_files/figure-html/unnamed-chunk-8-36.png" width="672"><img src="comparison_files/figure-html/unnamed-chunk-8-37.png" width="672"><img src="comparison_files/figure-html/unnamed-chunk-8-38.png" width="672"><img src="comparison_files/figure-html/unnamed-chunk-8-39.png" width="672"><img src="comparison_files/figure-html/unnamed-chunk-8-40.png" width="672"><img src="comparison_files/figure-html/unnamed-chunk-8-41.png" width="672"><img src="comparison_files/figure-html/unnamed-chunk-8-42.png" width="672"><img src="comparison_files/figure-html/unnamed-chunk-8-43.png" width="672"><img src="comparison_files/figure-html/unnamed-chunk-8-44.png" width="672"></p>
</div>
<div id="factor-distribution-from-statisticalroughness" class="section level2">
<h2 class="hasAnchor">
<a href="#factor-distribution-from-statisticalroughness" class="anchor"></a>Factor Distribution from <code>statisticalRoughness</code>
</h2>
<p>The following plots identify the number <span class="math inline">\(L\)</span> and all its factors on the number line. <strong>The factors appears similarly well-behaved for <span class="citation">Guillon et al. (2020)</span> and <code>statisticalRoughness</code> approaches.</strong></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">numberline</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="va">Lmax</span>
<span class="va">RL</span><span class="op">$</span><span class="va">allL</span><span class="op">[</span><span class="va">RL</span><span class="op">$</span><span class="va">allL</span> <span class="op">&lt;</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">Ls</span><span class="op">)</span><span class="op">]</span>
<span class="co">#&gt; [1] 24 30 36 40 42 48 54 56 60</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span>
<span class="kw">for</span> <span class="op">(</span><span class="va">k</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_along</a></span><span class="op">(</span><span class="va">RL</span><span class="op">$</span><span class="va">allL</span><span class="op">[</span><span class="va">RL</span><span class="op">$</span><span class="va">allL</span> <span class="op">&lt;</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">Ls</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">{</span>
    <span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>pty <span class="op">=</span> <span class="st">"s"</span><span class="op">)</span>
    <span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html">plot</a></span><span class="op">(</span><span class="va">numberline</span>, log <span class="op">=</span> <span class="st">"xy"</span>, lty <span class="op">=</span> <span class="fl">1</span>, ylab <span class="op">=</span> <span class="st">"Numbers"</span>, type <span class="op">=</span> <span class="st">"l"</span>, main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"All factors for"</span>, <span class="va">RL</span><span class="op">$</span><span class="va">allL</span><span class="op">[[</span><span class="va">k</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>
    <span class="fu"><a href="https://rdrr.io/r/graphics/grid.html">grid</a></span><span class="op">(</span><span class="op">)</span>
    <span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">numberline</span><span class="op">[</span><span class="va">numberline</span> <span class="op">%in%</span> <span class="va">RL</span><span class="op">$</span><span class="va">allR</span><span class="op">[[</span><span class="va">k</span><span class="op">]</span><span class="op">]</span><span class="op">]</span>, <span class="va">numberline</span><span class="op">[</span><span class="va">numberline</span> <span class="op">%in%</span> <span class="va">RL</span><span class="op">$</span><span class="va">allR</span><span class="op">[[</span><span class="va">k</span><span class="op">]</span><span class="op">]</span><span class="op">]</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span>
    <span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">numberline</span><span class="op">[</span><span class="va">numberline</span> <span class="op">%in%</span> <span class="va">RL</span><span class="op">$</span><span class="va">allL</span><span class="op">[[</span><span class="va">k</span><span class="op">]</span><span class="op">]</span><span class="op">]</span>, <span class="va">numberline</span><span class="op">[</span><span class="va">numberline</span> <span class="op">%in%</span> <span class="va">RL</span><span class="op">$</span><span class="va">allL</span><span class="op">[[</span><span class="va">k</span><span class="op">]</span><span class="op">]</span><span class="op">]</span>, col <span class="op">=</span> <span class="st">"red"</span>, pch<span class="op">=</span><span class="fl">19</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p><img src="comparison_files/figure-html/unnamed-chunk-9-1.png" width="672"><img src="comparison_files/figure-html/unnamed-chunk-9-2.png" width="672"><img src="comparison_files/figure-html/unnamed-chunk-9-3.png" width="672"><img src="comparison_files/figure-html/unnamed-chunk-9-4.png" width="672"><img src="comparison_files/figure-html/unnamed-chunk-9-5.png" width="672"><img src="comparison_files/figure-html/unnamed-chunk-9-6.png" width="672"><img src="comparison_files/figure-html/unnamed-chunk-9-7.png" width="672"><img src="comparison_files/figure-html/unnamed-chunk-9-8.png" width="672"><img src="comparison_files/figure-html/unnamed-chunk-9-9.png" width="672"></p>
</div>
</div>
<div id="distribution-of-surface-sizes-l" class="section level1">
<h1 class="hasAnchor">
<a href="#distribution-of-surface-sizes-l" class="anchor"></a>Distribution of Surface Sizes <span class="math inline">\(L\)</span>
</h1>
<p>Here I compare the distribution of the surface sizes <span class="math inline">\(L\)</span> on the number line. When indicated, <code>statisticalRoughness</code> approach is filtered so that <span class="math inline">\(L\)</span> are distributed logarithmically along the number line.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">numberline</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="va">Lmax</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>pty <span class="op">=</span> <span class="st">"s"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html">plot</a></span><span class="op">(</span><span class="va">numberline</span>, log <span class="op">=</span> <span class="st">"xy"</span>, lty <span class="op">=</span> <span class="fl">1</span>, ylab <span class="op">=</span> <span class="st">"Numbers"</span>, type <span class="op">=</span> <span class="st">"l"</span>, main <span class="op">=</span> <span class="st">"Original"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/grid.html">grid</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">numberline</span><span class="op">[</span><span class="va">numberline</span> <span class="op">%in%</span> <span class="va">df2017</span><span class="op">[</span>, <span class="fl">6</span><span class="op">]</span><span class="op">]</span>, <span class="va">numberline</span><span class="op">[</span><span class="va">numberline</span> <span class="op">%in%</span> <span class="va">df2017</span><span class="op">[</span>, <span class="fl">6</span><span class="op">]</span><span class="op">]</span>, col <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span></code></pre></div>
<p><img src="comparison_files/figure-html/unnamed-chunk-10-1.png" width="672"></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html">plot</a></span><span class="op">(</span><span class="va">numberline</span>, log <span class="op">=</span> <span class="st">"xy"</span>, lty <span class="op">=</span> <span class="fl">1</span>, ylab <span class="op">=</span> <span class="st">"Numbers"</span>, type <span class="op">=</span> <span class="st">"l"</span>, main <span class="op">=</span> <span class="st">"New"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/grid.html">grid</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">numberline</span><span class="op">[</span><span class="va">numberline</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="va">RL</span><span class="op">$</span><span class="va">allL</span><span class="op">)</span><span class="op">]</span>, <span class="va">numberline</span><span class="op">[</span><span class="va">numberline</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="va">RL</span><span class="op">$</span><span class="va">allL</span><span class="op">)</span><span class="op">]</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></code></pre></div>
<p><img src="comparison_files/figure-html/unnamed-chunk-10-2.png" width="672"></p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">RL</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_all_R_L.html">get_all_R_L</a></span><span class="op">(</span><span class="va">Lmax</span>, <span class="va">nR</span>, logfilter <span class="op">=</span> <span class="cn">TRUE</span>, len <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/ncell.html">nrow</a></span><span class="op">(</span><span class="va">df2017</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html">plot</a></span><span class="op">(</span><span class="va">numberline</span>, log <span class="op">=</span> <span class="st">"xy"</span>, lty <span class="op">=</span> <span class="fl">1</span>, ylab <span class="op">=</span> <span class="st">"Numbers"</span>, type <span class="op">=</span> <span class="st">"l"</span>, main <span class="op">=</span> <span class="st">"New (filtered)"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/grid.html">grid</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">numberline</span><span class="op">[</span><span class="va">numberline</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="va">RL</span><span class="op">$</span><span class="va">allL</span><span class="op">)</span><span class="op">]</span>, <span class="va">numberline</span><span class="op">[</span><span class="va">numberline</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="va">RL</span><span class="op">$</span><span class="va">allL</span><span class="op">)</span><span class="op">]</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></code></pre></div>
<p><img src="comparison_files/figure-html/unnamed-chunk-10-3.png" width="672"></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html">plot</a></span><span class="op">(</span><span class="va">numberline</span>, log <span class="op">=</span> <span class="st">"xy"</span>, lty <span class="op">=</span> <span class="fl">1</span>, ylab <span class="op">=</span> <span class="st">"Numbers"</span>, type <span class="op">=</span> <span class="st">"l"</span>, main <span class="op">=</span> <span class="st">"Original"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/grid.html">grid</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">numberline</span><span class="op">[</span><span class="va">numberline</span> <span class="op">%in%</span> <span class="va">df2017</span><span class="op">[</span>, <span class="fl">6</span><span class="op">]</span><span class="op">]</span>, <span class="va">numberline</span><span class="op">[</span><span class="va">numberline</span> <span class="op">%in%</span> <span class="va">df2017</span><span class="op">[</span>, <span class="fl">6</span><span class="op">]</span><span class="op">]</span>, col <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html">plot</a></span><span class="op">(</span><span class="va">numberline</span>, log <span class="op">=</span> <span class="st">"xy"</span>, lty <span class="op">=</span> <span class="fl">1</span>, ylab <span class="op">=</span> <span class="st">"Numbers"</span>, type <span class="op">=</span> <span class="st">"l"</span>, main <span class="op">=</span> <span class="st">"New (filtered)"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/grid.html">grid</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">numberline</span><span class="op">[</span><span class="va">numberline</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="va">RL</span><span class="op">$</span><span class="va">allL</span><span class="op">)</span><span class="op">]</span>, <span class="va">numberline</span><span class="op">[</span><span class="va">numberline</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="va">RL</span><span class="op">$</span><span class="va">allL</span><span class="op">)</span><span class="op">]</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>v <span class="op">=</span> <span class="va">numberline</span><span class="op">[</span><span class="va">numberline</span> <span class="op">%in%</span> <span class="va">df2017</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">6</span><span class="op">]</span><span class="op">]</span>, col <span class="op">=</span> <span class="st">"blue"</span>, pch <span class="op">=</span> <span class="fl">19</span><span class="op">)</span></code></pre></div>
<p><img src="comparison_files/figure-html/unnamed-chunk-10-4.png" width="672"></p>
</div>
<div id="choosing-n_r" class="section level1">
<h1 class="hasAnchor">
<a href="#choosing-n_r" class="anchor"></a>Choosing <span class="math inline">\(n_R\)</span>
</h1>
<div id="all-numbers" class="section level2">
<h2 class="hasAnchor">
<a href="#all-numbers" class="anchor"></a>All Numbers</h2>
<p>This graph displays the number of factors for numbers between 2 and <span class="math inline">\(L_\textrm{max}\)</span>.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">numbers</span> <span class="op">&lt;-</span> <span class="fl">2</span><span class="op">:</span><span class="va">Lmax</span>
<span class="va">facts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">numbers</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="../reference/get_factors.html">get_factors</a></span><span class="op">(</span><span class="va">i</span><span class="op">)</span><span class="op">)</span> <span class="op">-</span> <span class="fl">2</span><span class="op">)</span>
<span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>Numbers <span class="op">=</span> <span class="va">numbers</span>, Factors <span class="op">=</span> <span class="va">facts</span><span class="op">)</span>
<span class="va">p_fact</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Factors</span>, y <span class="op">=</span> <span class="va">Numbers</span>, color <span class="op">=</span> <span class="va">Factors</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">geom_segment</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="fl">0</span>, xend <span class="op">=</span> <span class="va">Factors</span>, y <span class="op">=</span> <span class="va">Numbers</span>, yend <span class="op">=</span> <span class="va">Numbers</span>, color <span class="op">=</span> <span class="va">Factors</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">scale_colour_viridis</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">1</span>, begin <span class="op">=</span> <span class="fl">0</span>, end <span class="op">=</span> <span class="fl">.8</span>,  direction <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>, option <span class="op">=</span> <span class="st">"magma"</span>, aesthetics <span class="op">=</span> <span class="st">"colour"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span>
<span class="va">p_fact</span>  </code></pre></div>
<p><img src="comparison_files/figure-html/unnamed-chunk-11-1.png" width="672"></p>
<p>This graph displays the number of factors for numbers between 2 and 64. 24 is the first number with more than 5 factors but there are several numbers smaller than 24 that have 4 factors.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p_fact</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.window.html">ylim</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">64</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.window.html">xlim</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span> , <span class="fl">20</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="comparison_files/figure-html/unnamed-chunk-12-1.png" width="672"></p>
</div>
<div id="multiples-of-6-and-10" class="section level2">
<h2 class="hasAnchor">
<a href="#multiples-of-6-and-10" class="anchor"></a>Multiples of 6 and 10</h2>
<p>Of the numbers between 2 and 10, 6 and 10 have the greatest number of factors. In consequence, all multiple of these numbers also have a higher number of factors. In the following, I display factors such that <span class="math inline">\(a \in \left\{6;10\right\}\)</span>.</p>
<p>This graph displays the number of factors for numbers between 2 and <span class="math inline">\(L_\textrm{max}\)</span>.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">numbers</span> <span class="op">&lt;-</span> <span class="fl">2</span><span class="op">:</span><span class="va">Lmax</span>
<span class="va">facts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">numbers</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="../reference/get_factors.html">get_factors</a></span><span class="op">(</span><span class="va">i</span><span class="op">)</span><span class="op">)</span> <span class="op">-</span> <span class="fl">2</span><span class="op">)</span>
<span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>Numbers <span class="op">=</span> <span class="va">numbers</span>, Factors <span class="op">=</span> <span class="va">facts</span><span class="op">)</span>
<span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">Numbers</span> <span class="op">%%</span> <span class="fl">6</span> <span class="op">==</span> <span class="fl">0</span> <span class="op">|</span> <span class="va">df</span><span class="op">$</span><span class="va">Numbers</span> <span class="op">%%</span> <span class="fl">10</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span>, <span class="op">]</span>
<span class="va">p_fact</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Factors</span>, y <span class="op">=</span> <span class="va">Numbers</span>, color <span class="op">=</span> <span class="va">Factors</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">geom_segment</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="fl">0</span>, xend <span class="op">=</span> <span class="va">Factors</span>, y <span class="op">=</span> <span class="va">Numbers</span>, yend <span class="op">=</span> <span class="va">Numbers</span>, color <span class="op">=</span> <span class="va">Factors</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">scale_colour_viridis</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">1</span>, begin <span class="op">=</span> <span class="fl">0</span>, end <span class="op">=</span> <span class="fl">.8</span>,  direction <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>, option <span class="op">=</span> <span class="st">"magma"</span>, aesthetics <span class="op">=</span> <span class="st">"colour"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span>
<span class="va">p_fact</span>  </code></pre></div>
<p><img src="comparison_files/figure-html/unnamed-chunk-13-1.png" width="672"></p>
<p>This graph displays the number of factors for numbers between 2 and 64.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p_fact</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.window.html">ylim</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">64</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.window.html">xlim</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span> , <span class="fl">20</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="comparison_files/figure-html/unnamed-chunk-14-1.png" width="672"></p>
</div>
<div id="multiples-of-12" class="section level2">
<h2 class="hasAnchor">
<a href="#multiples-of-12" class="anchor"></a>Multiples of 12</h2>
<p>Interestingly as 12 is the first number with at least 4 factors, all subsequent multiples of 12 have at least 4 factors. In the following, I display factors such that: <span class="math inline">\(a \in \left\{6;10;12\right\}\)</span>.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">numbers</span> <span class="op">&lt;-</span> <span class="fl">2</span><span class="op">:</span><span class="va">Lmax</span>
<span class="va">facts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">numbers</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="../reference/get_factors.html">get_factors</a></span><span class="op">(</span><span class="va">i</span><span class="op">)</span><span class="op">)</span> <span class="op">-</span> <span class="fl">2</span><span class="op">)</span>
<span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>Numbers <span class="op">=</span> <span class="va">numbers</span>, Factors <span class="op">=</span> <span class="va">facts</span><span class="op">)</span>
<span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">Numbers</span> <span class="op">%%</span> <span class="fl">6</span> <span class="op">==</span> <span class="fl">0</span> <span class="op">|</span> <span class="va">df</span><span class="op">$</span><span class="va">Numbers</span> <span class="op">%%</span> <span class="fl">10</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span>, <span class="op">]</span>
<span class="va">df</span><span class="op">$</span><span class="va">multiple</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/factor.html">as.factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">Numbers</span> <span class="op">%%</span> <span class="fl">6</span> <span class="op">==</span> <span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">Numbers</span> <span class="op">%%</span> <span class="fl">12</span> <span class="op">==</span> <span class="fl">0</span>, <span class="st">"Twelve"</span>, <span class="st">"Six"</span><span class="op">)</span>, <span class="st">"Ten"</span><span class="op">)</span><span class="op">)</span>
<span class="va">p_fact</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Factors</span>, y <span class="op">=</span> <span class="va">Numbers</span>, color <span class="op">=</span> <span class="va">multiple</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">geom_segment</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="fl">0</span>, xend <span class="op">=</span> <span class="va">Factors</span>, y <span class="op">=</span> <span class="va">Numbers</span>, yend <span class="op">=</span> <span class="va">Numbers</span>, color <span class="op">=</span> <span class="va">multiple</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span>
<span class="va">p_fact</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.window.html">ylim</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">64</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.window.html">xlim</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span> , <span class="fl">20</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="comparison_files/figure-html/unnamed-chunk-15-1.png" width="672"></p>
<p>In the following, I display factors such that: <span class="math inline">\(a = 12\)</span>.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">numberline</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="va">Lmax</span>
<span class="va">RL</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_all_R_L.html">get_all_R_L</a></span><span class="op">(</span><span class="va">Lmax</span>, <span class="fl">4</span>, only <span class="op">=</span> <span class="fl">12</span>, logfilter <span class="op">=</span> <span class="cn">TRUE</span>, len <span class="op">=</span> <span class="fl">32</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span>
<span class="kw">for</span> <span class="op">(</span><span class="va">k</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_along</a></span><span class="op">(</span><span class="va">RL</span><span class="op">$</span><span class="va">allL</span><span class="op">[</span><span class="va">RL</span><span class="op">$</span><span class="va">allL</span> <span class="op">&lt;</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">Ls</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">{</span>
    <span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>pty <span class="op">=</span> <span class="st">"s"</span><span class="op">)</span>
    <span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html">plot</a></span><span class="op">(</span><span class="va">numberline</span>, log <span class="op">=</span> <span class="st">"xy"</span>, lty <span class="op">=</span> <span class="fl">1</span>, ylab <span class="op">=</span> <span class="st">"Numbers"</span>, type <span class="op">=</span> <span class="st">"l"</span>, main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"All factors for"</span>, <span class="va">RL</span><span class="op">$</span><span class="va">allL</span><span class="op">[[</span><span class="va">k</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>
    <span class="fu"><a href="https://rdrr.io/r/graphics/grid.html">grid</a></span><span class="op">(</span><span class="op">)</span>
    <span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">numberline</span><span class="op">[</span><span class="va">numberline</span> <span class="op">%in%</span> <span class="va">RL</span><span class="op">$</span><span class="va">allR</span><span class="op">[[</span><span class="va">k</span><span class="op">]</span><span class="op">]</span><span class="op">]</span>, <span class="va">numberline</span><span class="op">[</span><span class="va">numberline</span> <span class="op">%in%</span> <span class="va">RL</span><span class="op">$</span><span class="va">allR</span><span class="op">[[</span><span class="va">k</span><span class="op">]</span><span class="op">]</span><span class="op">]</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span>
    <span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">numberline</span><span class="op">[</span><span class="va">numberline</span> <span class="op">%in%</span> <span class="va">RL</span><span class="op">$</span><span class="va">allL</span><span class="op">[[</span><span class="va">k</span><span class="op">]</span><span class="op">]</span><span class="op">]</span>, <span class="va">numberline</span><span class="op">[</span><span class="va">numberline</span> <span class="op">%in%</span> <span class="va">RL</span><span class="op">$</span><span class="va">allL</span><span class="op">[[</span><span class="va">k</span><span class="op">]</span><span class="op">]</span><span class="op">]</span>, col <span class="op">=</span> <span class="st">"red"</span>, pch<span class="op">=</span><span class="fl">19</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p><img src="comparison_files/figure-html/unnamed-chunk-16-1.png" width="672"><img src="comparison_files/figure-html/unnamed-chunk-16-2.png" width="672"><img src="comparison_files/figure-html/unnamed-chunk-16-3.png" width="672"><img src="comparison_files/figure-html/unnamed-chunk-16-4.png" width="672"><img src="comparison_files/figure-html/unnamed-chunk-16-5.png" width="672"></p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html">plot</a></span><span class="op">(</span><span class="va">numberline</span>, log <span class="op">=</span> <span class="st">"xy"</span>, lty <span class="op">=</span> <span class="fl">1</span>, ylab <span class="op">=</span> <span class="st">"Numbers"</span>, type <span class="op">=</span> <span class="st">"l"</span>, main <span class="op">=</span> <span class="st">"Original"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/grid.html">grid</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">numberline</span><span class="op">[</span><span class="va">numberline</span> <span class="op">%in%</span> <span class="va">df2017</span><span class="op">[</span>, <span class="fl">6</span><span class="op">]</span><span class="op">]</span>, <span class="va">numberline</span><span class="op">[</span><span class="va">numberline</span> <span class="op">%in%</span> <span class="va">df2017</span><span class="op">[</span>, <span class="fl">6</span><span class="op">]</span><span class="op">]</span>, col <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html">plot</a></span><span class="op">(</span><span class="va">numberline</span>, log <span class="op">=</span> <span class="st">"xy"</span>, lty <span class="op">=</span> <span class="fl">1</span>, ylab <span class="op">=</span> <span class="st">"Numbers"</span>, type <span class="op">=</span> <span class="st">"l"</span>, main <span class="op">=</span> <span class="st">"New (filtered, multiples of 12)"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/grid.html">grid</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">numberline</span><span class="op">[</span><span class="va">numberline</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="va">RL</span><span class="op">$</span><span class="va">allL</span><span class="op">)</span><span class="op">]</span>, <span class="va">numberline</span><span class="op">[</span><span class="va">numberline</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="va">RL</span><span class="op">$</span><span class="va">allL</span><span class="op">)</span><span class="op">]</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>v <span class="op">=</span> <span class="va">numberline</span><span class="op">[</span><span class="va">numberline</span> <span class="op">%in%</span> <span class="va">df2017</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">6</span><span class="op">]</span><span class="op">]</span>, col <span class="op">=</span> <span class="st">"blue"</span>, pch <span class="op">=</span> <span class="fl">19</span><span class="op">)</span></code></pre></div>
<p><img src="comparison_files/figure-html/unnamed-chunk-16-6.png" width="672"></p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">RL</span><span class="op">$</span><span class="va">allL</span><span class="op">)</span>
<span class="co">#&gt;  [1]   12   24   36   48   60   72   84   96  120  144  180  216  252  312  372</span>
<span class="co">#&gt; [16]  444  528  636  768  924 1104 1332 1596 1908 2292 2748 3300 3960 4740 5688</span>
<span class="co">#&gt; [31] 6816 8184</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">RL</span><span class="op">$</span><span class="va">allL</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">RL</span><span class="op">$</span><span class="va">allL</span> <span class="op">%in%</span> <span class="va">df2017</span><span class="op">[</span>, <span class="fl">6</span><span class="op">]</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>
<span class="co">#&gt; [1]  96 768</span></code></pre></div>
<p>Of these surface sizes, two appeared in <span class="citation">Guillon et al. (2020)</span>: 192 and 1536. Importantly, using this new approach divides by 5.3 the smaller scale at which fractal dimension was computed in <span class="citation">Guillon et al. (2020)</span> (120-m vs 640-m).</p>
</div>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<div id="refs" class="references">
<div id="ref-Guillon2020">
<p>Guillon, Hervé, Colin F Byrne, Belize A Lane, Samuel Sandoval Solis, and Gregory B Pasternack. 2020. “Machine Learning Predicts Reach-Scale Channel Types from Coarse-Scale Geospatial Data in a Large River Basin.” <em>Water Resources Research</em>.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Hervé Guillon.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
